scratchpad patch added
various tweaks
